{"ts":1485754838354,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"#!/bin/sh\n#\n# JBoss standalone control script\n#\n# chkconfig: - 80 20\n# description: JBoss AS Standalone\n# processname: standalone\n# pidfile: /var/run/jboss-as/jboss-as-standalone.pid\n# config: /etc/jboss-as/jboss-as.conf\n\n# Source function library.\n. /etc/init.d/functions\n\n# Load Java configuration.\n[ -r /etc/java/java.conf ] && . /etc/java/java.conf\nexport JAVA_HOME\n\n##\n# Set the JBoss user\nJBOSS_USER=jboss  \nexport JBOSS_USER \n\n# Load JBoss AS init.d configuration.\nif [ -z \"$JBOSS_CONF\" ]; then\n  JBOSS_CONF=\"/etc/jboss-as/jboss-as.conf\"\nfi\n\n[ -r \"$JBOSS_CONF\" ] && . \"${JBOSS_CONF}\"\n\n# Set defaults.\n\nif [ -z \"$JBOSS_HOME\" ]; then\n  JBOSS_HOME=/usr/share/jboss-as\nfi\nexport JBOSS_HOME\n\nif [ -z \"$JBOSS_PIDFILE\" ]; then\n  JBOSS_PIDFILE=/var/run/jboss-as/jboss-as-standalone.pid\nfi\nexport JBOSS_PIDFILE\n\nif [ -z \"$JBOSS_CONSOLE_LOG\" ]; then\n  JBOSS_CONSOLE_LOG=/var/log/jboss-as/console.log\nfi\n\nif [ -z \"$STARTUP_WAIT\" ]; then\n  STARTUP_WAIT=30\nfi\n\nif [ -z \"$SHUTDOWN_WAIT\" ]; then\n  SHUTDOWN_WAIT=30\nfi\n\nif [ -z \"$JBOSS_CONFIG\" ]; then\n  JBOSS_CONFIG=standalone.xml\nfi\n\nJBOSS_SCRIPT=$JBOSS_HOME/bin/standalone.sh\n\nprog='jboss-as'\n\nCMD_PREFIX=''\n\nif [ ! -z \"$JBOSS_USER\" ]; then\n  if [ -x /etc/rc.d/init.d/functions ]; then\n    CMD_PREFIX=\"daemon --user $JBOSS_USER\"\n  else\n    CMD_PREFIX=\"su - $JBOSS_USER -c\"\n  fi\nfi\n\nstart() {\n  echo -n \"Starting $prog: \"\n  if [ -f $JBOSS_PIDFILE ]; then\n    read ppid < $JBOSS_PIDFILE\n    if [ `ps --pid $ppid 2> /dev/null | grep -c $ppid 2> /dev/null` -eq '1' ]; then\n      echo -n \"$prog is already running\"\n      failure\n      echo\n      return 1 \n    else\n      rm -f $JBOSS_PIDFILE\n    fi\n  fi\n  mkdir -p $(dirname $JBOSS_CONSOLE_LOG)\n  cat /dev/null > $JBOSS_CONSOLE_LOG\n\n  mkdir -p $(dirname $JBOSS_PIDFILE)\n  chown $JBOSS_USER $(dirname $JBOSS_PIDFILE) || true\n  #$CMD_PREFIX JBOSS_PIDFILE=$JBOSS_PIDFILE $JBOSS_SCRIPT 2>&1 > $JBOSS_CONSOLE_LOG &\n  #$CMD_PREFIX JBOSS_PIDFILE=$JBOSS_PIDFILE $JBOSS_SCRIPT &\n\n  if [ ! -z \"$JBOSS_USER\" ]; then\n    if [ -x /etc/rc.d/init.d/functions ]; then\n      daemon --user $JBOSS_USER LAUNCH_JBOSS_IN_BACKGROUND=1 JBOSS_PIDFILE=$JBOSS_PIDFILE $JBOSS_SCRIPT -c $JBOSS_CONFIG 2>&1 > $JBOSS_CONSOLE_LOG &\n    else\n      su - $JBOSS_USER -c \"LAUNCH_JBOSS_IN_BACKGROUND=1 JBOSS_PIDFILE=$JBOSS_PIDFILE $JBOSS_SCRIPT -c $JBOSS_CONFIG\" 2>&1 > $JBOSS_CONSOLE_LOG &\n    fi\n  fi\n\n  count=0\n  launched=false\n\n  until [ $count -gt $STARTUP_WAIT ]\n  do\n    grep 'JBoss AS.*started in' $JBOSS_CONSOLE_LOG > /dev/null \n    if [ $? -eq 0 ] ; then\n      launched=true\n      break\n    fi \n    sleep 1\n    let count=$count+1;\n  done\n  \n  success\n  echo\n  return 0\n}\n\nstop() {\n  echo -n $\"Stopping $prog: \"\n  count=0;\n\n  if [ -f $JBOSS_PIDFILE ]; then\n    read kpid < $JBOSS_PIDFILE\n    let kwait=$SHUTDOWN_WAIT\n\n    # Try issuing SIGTERM\n\n    kill -15 $kpid\n    until [ `ps --pid $kpid 2> /dev/null | grep -c $kpid 2> /dev/null` -eq '0' ] || [ $count -gt $kwait ]\n    do\n      sleep 1\n      let count=$count+1;\n    done\n\n    if [ $count -gt $kwait ]; then\n      kill -9 $kpid\n    fi\n  fi\n  rm -f $JBOSS_PIDFILE\n  success\n  echo\n}\n\nstatus() {\n  if [ -f $JBOSS_PIDFILE ]; then\n    read ppid < $JBOSS_PIDFILE\n    if [ `ps --pid $ppid 2> /dev/null | grep -c $ppid 2> /dev/null` -eq '1' ]; then\n      echo \"$prog is running (pid $ppid)\"\n      return 0\n    else\n      echo \"$prog dead but pid file exists\"\n      return 1\n    fi\n  fi\n  echo \"$prog is not running\"\n  return 3\n}\n\ncase \"$1\" in\n  start)\n      start\n      ;;\n  stop)\n      stop\n      ;;\n  restart)\n      $0 stop\n      $0 start\n      ;;\n  status)\n      status\n      ;;\n  *)\n      ## If no parameters are given, print which are avaiable.\n      echo \"Usage: $0 {start|stop|status|restart|reload}\"\n      exit 1\n      ;;\nesac\n"]],"start1":0,"start2":0,"length1":0,"length2":3744}]],"length":3744}
